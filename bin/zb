#!/usr/bin/env node
'use strict';

var fs = require('fs');

function runCode(source, filename) {
  var zoidberg = require('../');
  zoidberg.runMain(source, {
    filename: filename
  });
}

var programFile = process.argv[2];
if (programFile === '-') {
  var buffer = '';
  process.stdin
    .on('data', function(chunk) {
      buffer += chunk.toString('utf8');
    })
    .on('end', function() {
      runCode(buffer, '/dev/stdin');
    });
} else {
  if (typeof programFile !== 'string') {
    throw new Error('Usage: zb [ <filename> | - ] args*');
  }
  runCode(fs.readFileSync(programFile, 'utf8'), programFile);
}
